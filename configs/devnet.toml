# IPPAN-L2 Devnet Configuration (REAL L1 RPC)
#
# This profile is intended to run IPPAN-L2 against a real IPPAN CORE devnet.
#
# Usage:
#   export IPPAN_L2_CONFIG=./configs/devnet.toml
#   cargo run -p fin-node -- --l1-mode http l1 check
#   cargo run -p fin-node -- --l1-mode http run
#
# IMPORTANT:
# - Do NOT invent endpoint paths in code.
# - Fill **all** `l1.endpoints.*` paths from IPPAN CORE devnet RPC documentation.
# - Do NOT commit secrets; use `env:VAR` for sensitive values.

[node]
# Included in logs as node identity.
label = "devnet-fin-node-1"

[l1]
# REQUIRED: IPPAN CORE devnet base URL (scheme+host+port only)
base_url = "https://REPLACE_WITH_IPPAN_CORE_DEVNET_BASE_URL"

# Optional auth token / API key for the L1 RPC (never logged).
# api_key = "env:L1_API_KEY"
api_key = ""

# Timeouts (ms)
connect_timeout_ms = 3000
request_timeout_ms = 10000

# Optional readiness gate: require L1 status network_id to match this exact value.
# expected_network_id = "ippan-devnet"

[l1.retry]
# Bounded retries for transient errors only (timeouts, 5xx, connection reset).
max_attempts = 5
base_delay_ms = 250
max_delay_ms = 3000

[l1.endpoints]
# REQUIRED endpoint paths (paths only, not full URLs).
#
# Replace the values below with the *actual* IPPAN CORE devnet RPC paths.
chain_status = "REPLACE_WITH_STATUS_PATH"
submit_batch = "REPLACE_WITH_SUBMIT_BATCH_PATH"
get_inclusion = "REPLACE_WITH_GET_INCLUSION_PATH_WITH_{id}"
get_finality = "REPLACE_WITH_GET_FINALITY_PATH_WITH_{l1_tx_id}"

[server]
bind_address = "0.0.0.0:3000"
metrics_enabled = true
max_inflight_requests = 64

[limits]
# Devnet: moderate defaults (bigger than prod, still bounded).
max_body_bytes = 524288
max_string_bytes = 2048
max_tags = 64
max_tag_bytes = 64
max_batch_items = 512
max_receipt_bytes = 524288
max_json_depth = 64

[rate_limit]
enabled = true
requests_per_minute = 600
burst = 200

[pagination]
default_limit = 50
max_limit = 200

[retention]
receipts_days = 14
recon_failed_days = 7
min_receipts_keep = 200

[pruning]
enabled = false
interval_secs = 86400

[cors]
enabled = false
allow_origins = []

[storage]
# Receipt output directory (relative to working directory or absolute).
receipts_dir = "receipts"
recon_db_dir = "recon_db"

[recon]
enabled = true
# Devnet defaults: faster polling than prod.
interval_secs = 10
batch_limit = 50
max_scan = 5000
max_attempts = 50
base_delay_secs = 2
max_delay_secs = 300

[linkage]
entitlement_policy = "optimistic"

[logging]
level = "info"
format = "json"

